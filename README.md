Тестовое задание по вакансии "Разработчик IBMi" 

Задание выполнено на MySQL + Python (явного ограничения в задании на используемую субд не было).
mysql_scoringDBwData.sql содержит базу данных с рандомно сгенерированными данными, поэтому при выборке имеют место быть логические несостыковки.
Задание 2.sql содержит sql-запросы, а db_grabber.py - приложение из 3 задания 
Для работы приложения требуется интерпретатор Python 3.4 и MySQL Connector/Python (3.4)
(Возвращаемые приложением данные не совсем соответствуют данному в задании шаблону ввиду того, что когда я его писал, я не знал что означает "(Map<Enum, Client[]>)")

Ниже текст задания:

 
Задание  1 

Спроектируйте  ER-модель  схемы  базы  данных  системы  кредитного скоринга.  Система  предназначена  для  вынесения  решения о возможности  предоставления  кредита  клиенту,  оформляющему заказ  у  партнера  банка.  Проектируемая  система  должна удовлетворять  следующим  user  story: 
 
1. Я,  как  клиент  банка,  хочу  купить  товар  в  интернет-магазине партнера  банка  в  кредит.  После  выбора  товара  я  заполняю анкету  и  получаю  решение  о  возможности  получения  кредита. 
2. Я,  как  партнер  банка,  передаю  заполненную  клиентом  анкету  в банк,  получаю  решение  (Y/N)  о  возможности  предоставления кредита  и  сообщаю  его  клиенту.  Также  я  могу  получить статистику  взаимодействия  с  банком  (кол-во  выданных кредитов,  обращений  и  т.д.). 
3. Я,  как  система  кредитного  скоринга,  получаю  на  вход  от партера  заполненную  анкету  клиента.  Используя  внутренний черный  список  клиентов  банка,  данные  из  БКИ,  перечень экстремистов,  данные  о  транзакциях  клиента  и  модель принятия  решения  (предполагается,  что  модель  уже существует  и  включает  пол,  возраст,  доход,  сумму  кредита  и прочие  параметры),  провожу  онлайн-скоринг  и  делаю заключение  о  возможности  предоставления  кредита. 
4. Я,  как  представитель  банка,  могу  в  любой  момент  посмотреть статистику  обращений  всех  партнеров,  посмотреть  текущий статус  рассмотрения  конкретной  заявки,  ошибки  работы системы,  имею  возможность  добавлять,  удалять  партнеров. 

Задание  2

Напишите  SQL  запрос,  который: 
1. Отображает  статистику  по  партнерам:  партнер,  общее количество  заявок,  количество  одобренных  заявок,  количество отказов,  количество  выданных  денег. 
2. Отображает  все  заявки  по  конкретному  партнеру  с  указанием параметров  заявки  и  ее  текущего  статуса,  причину  отказа в кредите. 
 
Задание  3

Напишите  на  любом  языке  (RPG,  Java,  C,  C++,  Python  и  др.) приложение,  которое  возвращает  массив  клиентов  в  разрезе причин  отказа  в  выдаче  кредита  (Map<Enum,  Client[]>)  за  заданный интервал  дат.
